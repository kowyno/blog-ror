<div class="max-w-2xl mx-auto bg-white rounded-xl shadow-md p-8 mt-8">
  <div class="mb-6">
    <h1 class="text-3xl font-bold mb-2 text-gray-900"><%= @article.title %></h1>
    <%= publication_state_badge(@article) %>
    <div class="flex items-center gap-2 text-sm text-gray-500">
      <%= icon_user %>
      <span>Por <%= user_display_name(@article.user) %></span>
      <span class="text-gray-400">•</span>
      <%= icon_calendar %>
      <span><%= @article.created_at.strftime("%d/%m/%Y") %></span>
      <span class="text-gray-400">•</span>
      <%= icon_clock %>
      <span><%= @article.created_at.strftime("%H:%M") %></span>
    </div>
  </div>
  <p class="text-gray-700 text-lg mb-6 whitespace-pre-line"><%= @article.body %></p>
  <div class="flex gap-4 mb-8 flex-wrap">
    <% if policy(@article).edit? %>
      <% if @article.draft? && policy(@article).publish? %>
        <%= link_to publish_article_path(@article), data: { turbo_method: :patch, turbo_confirm: "¿Seguro que quieres publicar este artículo?" }, class: "flex flex-row items-center space-x-2 px-4 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-full font-medium transition" do %>
          <%= icon_plus %>
          <span>Publicar</span>
        <% end %>
      <% elsif @article.published? && policy(@article).unpublish? %>
        <%= link_to unpublish_article_path(@article), data: { turbo_method: :patch, turbo_confirm: "¿Seguro que quieres despublicar este artículo?" }, class: "flex flex-row items-center space-x-2 px-4 py-2 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-full font-medium transition" do %>
          <%= icon_plus %>
          <span>Despublicar</span>
        <% end %>
      <% end %>

      <%= link_to edit_article_path, class: "flex flex-row items-center space-x-2 px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-full font-medium transition" do %>
        <%= icon_edit %>
        <span>Editar</span>
      <% end %>
      
      <%= link_to article_path(@article), data: { turbo_method: :delete, turbo_confirm: "¿Seguro que quieres eliminar este articulo?" }, class: "flex flex-row items-center space-x-2 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-full font-medium transition" do %>
        <%= icon_delete %>
        <span>Eliminar</span>
      <% end %>
    <% else %>
      <% if @article.draft? %>
        <div title="¡No puedes realizar esta acción!" class="flex flex-row items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-full font-medium transition">
          <%= icon_plus %>
          <span>Publicar</span>
        </div>
      <% elsif @article.published? %>
        <div title="¡No puedes realizar esta acción!" class="flex flex-row items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-full font-medium transition">
          <%= icon_plus %>
          <span>Despublicar</span>
        </div>
      <% end %>

      <div title="¡No puedes realizar esta acción!" class="flex flex-row items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-full font-medium transition">
        <%= icon_edit %>
        <span>Editar</span>
      </div>
      
      <div title="¡No puedes realizar esta acción!" class="flex flex-row items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-full font-medium transition">
        <%= icon_delete %>
        <span>Eliminar</span>
      </div>
    <% end %>
  </div>
  <div class="border-t pt-6">
    <h2 class="text-xl font-semibold mb-4 text-gray-800">Comentarios:</h2>
    <div class="space-y-4">
      <%= render @article.comments %>
    </div>
  </div>
  <div class="border-t pt-6 mt-8">
    <% if user_signed_in? %>
      <h2 class="text-xl font-semibold mb-4 text-gray-800">Agregar comentario:</h2>
      <%= render "comments/form", article: @article %>
    <% else %>
      <div class="text-center py-6">
        <p class="text-gray-600 mb-4">Debes estar logueado para comentar</p>
        <%= link_to "Iniciar sesión", new_user_session_path, class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" %>
      </div>
    <% end %>
  </div>
</div>